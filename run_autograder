#!/usr/bin/env bash

# Update autograder files

. /autograder/source/env.sh
. /autograder/source/envVars.sh

echo \$REPO_NAME=${REPO_NAME}
pwd
cd /autograder/git-repo/${REPO_NAME}
pwd
git pull origin master

rm -rf deploy_keys

if [ -f MAKE-REFERENCE.sh ]; then
    echo "Running ./MAKE-REFERENCE.sh from ${REPO_NAME}"
    chmod u+x ./MAKE-REFERENCE.sh
    ./MAKE-REFERENCE.sh
fi

if [ -d REFERENCE-SOLUTION ]; then
   echo "Removing REFERENCE_SOLUTION from container"
   rm -rf REFERENCE-SOLUTION
fi

if [ -f ./run_autograder ]; then
    echo "Running ./run_autograder from ${REPO_NAME}"
    chmod u+x ./run_autograder
    ./run_autograder
elif [ -f ./grade.sh ]; then
    echo "Running ./grade.sh from ${REPO_NAME}"
    chmod u+x ./grade.sh
    ./grade.sh
fi




